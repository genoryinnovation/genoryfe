import{d as N,r as k,o as T,y as F,a as p,j as v,b as e,e as y,t as o,k as V,u as R,D as $,n as P,q as B,g as w,h as G,F as U,f as H,p as J,A as K,C as E}from"./index-CVDPA8xH.js";import{O as I}from"./order.service-DuXVhfDF.js";import"./api-4GkiaaGr.js";function q(a,r){a.src=r}const W=a=>{var r,l,t,n="The Google Maps JavaScript API",d="google",h="importLibrary",f="__ib__",c=document,s=window,u=s[d]||(s[d]={}),i=u.maps||(u.maps={}),b=new Set,m=new URLSearchParams,S=()=>r||(r=new Promise(async(x,_)=>{var A;await(l=c.createElement("script")),m.set("libraries",[...b]+"");for(t in a)m.set(t.replace(/[A-Z]/g,M=>"_"+M[0].toLowerCase()),a[t]);m.set("callback",d+".maps."+f),q(l,"https://maps.googleapis.com/maps/api/js?"+m),i[f]=x,l.onerror=()=>r=_(Error(n+" could not load.")),l.nonce=((A=c.querySelector("script[nonce]"))==null?void 0:A.nonce)||"",c.head.append(l)}));i[h]?console.warn(n+" only loads once. Ignoring:",a):i[h]=(x,..._)=>b.add(x)&&S().then(()=>i[h](x,..._))},Y=a=>`The setOptions() function should only be called once. The options passed to the additional call (${JSON.stringify(a)}) will be ignored.`,Z=a=>`The google.maps.importLibrary() function is already defined, and @googlemaps/js-api-loader will use the existing function instead of overwriting it. The options passed to setOptions (${JSON.stringify(a)}) will be ignored.`,Q=()=>{},X=()=>{};let D=!1;function ee(a){if(D){Q(Y(a));return}te(a),D=!0}async function C(a){var r,l;if(!((l=(r=window==null?void 0:window.google)==null?void 0:r.maps)!=null&&l.importLibrary))throw new Error("google.maps.importLibrary is not installed.");return await google.maps.importLibrary(a)}function te(a){var l,t;const r=!!((t=(l=window.google)==null?void 0:l.maps)!=null&&t.importLibrary);r&&X(Z(a)),r||W(a)}const se={class:"w-full h-96 bg-gray-100 rounded-lg overflow-hidden relative"},oe={key:0,class:"absolute inset-0 flex items-center justify-center bg-gray-100 bg-opacity-75 z-10"},re={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-100 z-10"},ae={class:"text-red-600"},le="AIzaSyBkZraD0rt4dP0TslLVMexomnye48jFcW0",ie=N({__name:"OrderTrackingMap",props:{deliveryAddress:{},orderStatus:{}},setup(a){const r=a,l=k(null),t=k(!0),n=k(null);let d=null,h=null;const f=async()=>{if(l.value){t.value=!0,n.value=null;try{ee({key:le,v:"weekly",libraries:["places"]});const{Map:s}=await C("maps"),{Marker:u}=await C("marker"),i={lat:6.5244,lng:3.3792};d=new s(l.value,{center:i,zoom:12,mapId:"DEMO_MAP_ID"}),r.deliveryAddress?await c(d,u):t.value=!1}catch(s){console.error("Error loading Google Maps:",s),n.value="Failed to load map.",t.value=!1}}},c=async(s,u)=>{if(!r.deliveryAddress)return;let i=null;if(r.deliveryAddress.latitude&&r.deliveryAddress.longitude)i={lat:r.deliveryAddress.latitude,lng:r.deliveryAddress.longitude};else{const b=`${r.deliveryAddress.street}, ${r.deliveryAddress.city}, ${r.deliveryAddress.state}, ${r.deliveryAddress.country}`;try{const{Geocoder:m}=await C("geocoding"),x=await new m().geocode({address:b});x.results&&x.results.length>0?i=x.results[0].geometry.location.toJSON():n.value="Could not find location for this address."}catch(m){console.error("Geocoding error:",m),n.value="Error finding location."}}i&&(s.setCenter(i),s.setZoom(15),h&&h.setMap(null),h=new u({position:i,map:s,title:"Delivery Location",animation:google.maps.Animation.DROP})),t.value=!1};return T(()=>{f()}),F(()=>r.deliveryAddress,()=>{d&&f()},{deep:!0}),(s,u)=>(v(),p("div",se,[e("div",{ref_key:"mapContainer",ref:l,class:"w-full h-full"},null,512),t.value?(v(),p("div",oe,[...u[0]||(u[0]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)])])):y("",!0),n.value?(v(),p("div",re,[e("p",ae,o(n.value),1)])):y("",!0)]))}}),ne={key:0,class:"space-y-6"},de={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},ce={class:"flex items-center space-x-4"},ue={class:"text-2xl font-bold text-slate-900"},pe={class:"flex items-center mt-1 space-x-3"},ve={class:"text-sm text-slate-500"},me={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},xe={class:"lg:col-span-2 space-y-6"},he={key:0,class:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden"},ge={class:"p-4"},fe={class:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden"},be={class:"px-6 py-4 border-b border-slate-100 flex items-center space-x-3"},ye={class:"px-2 py-0.5 bg-slate-100 text-slate-600 text-xs font-medium rounded-full"},_e={class:"divide-y divide-slate-100"},we={class:"h-16 w-16 rounded-xl overflow-hidden bg-slate-100 flex-shrink-0"},ke=["src"],Se={class:"ml-4 flex-1 min-w-0"},Ae={class:"text-sm font-semibold text-slate-900 truncate"},Me={class:"mt-1 flex items-center space-x-2"},Ce={class:"px-2 py-0.5 bg-slate-100 text-slate-600 text-xs font-medium rounded-md"},Le={class:"text-xs text-slate-400"},Oe={class:"text-right ml-4"},je={class:"text-sm font-semibold text-slate-900"},ze={class:"text-xs text-slate-500"},Pe={class:"bg-slate-50 px-6 py-4 border-t border-slate-100"},Be={class:"space-y-2"},Ee={class:"flex justify-between text-sm"},Ie={class:"text-slate-900 font-medium"},De={class:"flex justify-between text-sm"},Ne={class:"text-slate-900 font-medium"},Te={class:"pt-2 border-t border-slate-200 flex justify-between"},Fe={class:"text-lg font-bold text-primary-600"},Ve={class:"space-y-6"},Re={class:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6"},$e={class:"space-y-4"},Ge=["disabled"],Ue={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},He={class:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6"},Je={class:"flex items-center mb-4"},Ke={class:"w-12 h-12 rounded-full bg-gradient-to-br from-cyan-400 to-cyan-600 flex items-center justify-center text-white font-semibold text-lg"},qe={class:"ml-3"},We={class:"text-sm font-semibold text-slate-900"},Ye={class:"space-y-3 pt-4 border-t border-slate-100"},Ze={class:"flex items-center text-sm"},Qe={class:"text-slate-600 truncate"},Xe={class:"flex items-center text-sm"},et={class:"text-slate-600"},tt={key:0,class:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6"},st={class:"bg-slate-50 rounded-xl p-4"},ot={class:"text-sm font-medium text-slate-900"},rt={class:"text-sm text-slate-600 mt-1"},at={class:"text-sm text-slate-500"},lt={key:1,class:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6"},it={class:"bg-slate-50 rounded-xl p-4 space-y-3"},nt={class:"text-sm font-semibold text-slate-900"},dt={class:"text-sm text-slate-600"},ct={class:"text-xs text-slate-500"},ut={key:0},pt={class:"flex items-center mt-1"},vt={class:"text-sm text-slate-600"},mt={class:"flex items-center mt-1"},xt={class:"text-sm text-slate-600"},ht={key:1,class:"flex flex-col items-center justify-center py-16"},gt=N({__name:"[id]",setup(a){const r=V(),l=R(),t=k(null),n=k(""),d=k(!1),h=async()=>{try{const c=await I.getOrder(r.params.id);t.value=c.data,n.value=c.data.orderStatus}catch(c){console.error("Failed to fetch order",c)}},f=async()=>{if(t.value){d.value=!0;try{await I.updateOrderStatus(t.value._id,n.value),await h(),alert("Order status updated")}catch(c){console.error("Failed to update status",c),alert("Failed to update status")}finally{d.value=!1}}};return T(()=>{h()}),(c,s)=>{var u,i,b,m,S,x,_,A,M,L,O;return t.value?(v(),p("div",ne,[e("div",de,[e("div",ce,[e("button",{onClick:s[0]||(s[0]=g=>$(l).back()),class:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-xl transition-colors"},[...s[2]||(s[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e("div",null,[e("h1",ue," Order #"+o(t.value.orderNumber),1),e("div",pe,[e("span",{class:P(["inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold capitalize",{"bg-emerald-100 text-emerald-700":t.value.orderStatus==="delivered","bg-blue-100 text-blue-700":t.value.orderStatus==="shipped","bg-amber-100 text-amber-700":t.value.orderStatus==="pending","bg-purple-100 text-purple-700":t.value.orderStatus==="processing","bg-indigo-100 text-indigo-700":t.value.orderStatus==="ready_for_pickup","bg-cyan-100 text-cyan-700":t.value.orderStatus==="confirmed","bg-rose-100 text-rose-700":t.value.orderStatus==="cancelled"}])},[e("span",{class:P(["w-1.5 h-1.5 rounded-full mr-1.5",{"bg-emerald-500":t.value.orderStatus==="delivered","bg-blue-500":t.value.orderStatus==="shipped","bg-amber-500":t.value.orderStatus==="pending","bg-purple-500":t.value.orderStatus==="processing","bg-indigo-500":t.value.orderStatus==="ready_for_pickup","bg-cyan-500":t.value.orderStatus==="confirmed","bg-rose-500":t.value.orderStatus==="cancelled"}])},null,2),B(" "+o(t.value.orderStatus),1)],2),e("span",ve,o(new Date(t.value.createdAt).toLocaleDateString()),1)])])])]),e("div",me,[e("div",xe,[t.value.deliveryAddress?(v(),p("div",he,[s[3]||(s[3]=w('<div class="px-6 py-4 border-b border-slate-100 flex items-center space-x-3"><div class="p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg"><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></div><h3 class="text-lg font-semibold text-slate-900">Delivery Location</h3></div>',1)),e("div",ge,[G(ie,{deliveryAddress:t.value.deliveryAddress,orderStatus:t.value.orderStatus},null,8,["deliveryAddress","orderStatus"])])])):y("",!0),e("div",fe,[e("div",be,[s[4]||(s[4]=e("div",{class:"p-2 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])],-1)),s[5]||(s[5]=e("h3",{class:"text-lg font-semibold text-slate-900"},"Order Items",-1)),e("span",ye,o(((u=t.value.items)==null?void 0:u.length)||0)+" items",1)]),e("ul",_e,[(v(!0),p(U,null,H(t.value.items,g=>{var j,z;return v(),p("li",{key:g.product._id,class:"p-4 flex items-center hover:bg-slate-50/50 transition-colors"},[e("div",we,[e("img",{src:g.product.images[0]||"https://via.placeholder.com/60",class:"h-full w-full object-cover"},null,8,ke)]),e("div",Se,[e("div",Ae,o(g.product.title),1),e("div",Me,[e("span",Ce,"SKU: "+o(g.product.sku),1),e("span",Le,"Qty: "+o(g.quantity),1)])]),e("div",Oe,[e("div",je,o(t.value.currency)+" "+o((j=g.lineTotal)==null?void 0:j.toFixed(2)),1),e("div",ze,o(t.value.currency)+" "+o((z=g.price)==null?void 0:z.toFixed(2))+" each ",1)])])}),128))]),e("div",Pe,[e("div",Be,[e("div",Ee,[s[6]||(s[6]=e("span",{class:"text-slate-500"},"Subtotal",-1)),e("span",Ie,o(t.value.currency)+" "+o(((i=t.value.subtotal)==null?void 0:i.toFixed(2))||((b=t.value.totalAmount)==null?void 0:b.toFixed(2))),1)]),e("div",De,[s[7]||(s[7]=e("span",{class:"text-slate-500"},"Delivery Fee",-1)),e("span",Ne,o(t.value.currency)+" "+o(((m=t.value.deliveryFee)==null?void 0:m.toFixed(2))||"0.00"),1)]),e("div",Te,[s[8]||(s[8]=e("span",{class:"text-base font-semibold text-slate-900"},"Total",-1)),e("span",Fe,o(t.value.currency)+" "+o((S=t.value.totalAmount)==null?void 0:S.toFixed(2)),1)])])])])]),e("div",Ve,[e("div",Re,[s[12]||(s[12]=w('<div class="flex items-center space-x-3 mb-5"><div class="p-2 bg-gradient-to-br from-amber-500 to-amber-600 rounded-lg"><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><h3 class="text-lg font-semibold text-slate-900">Update Status</h3></div>',1)),e("div",$e,[e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"Order Status",-1)),J(e("select",{"onUpdate:modelValue":s[1]||(s[1]=g=>n.value=g),class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all"},[...s[9]||(s[9]=[w('<option value="pending">Pending</option><option value="confirmed">Confirmed</option><option value="processing">Processing</option><option value="ready_for_pickup">Ready for Pickup</option><option value="shipped">Shipped</option><option value="delivered">Delivered</option><option value="cancelled">Cancelled</option>',7)])],512),[[K,n.value]])]),e("button",{onClick:f,disabled:d.value,class:"w-full inline-flex justify-center items-center py-3 px-4 text-sm font-semibold rounded-xl text-white bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 shadow-lg shadow-primary-500/25 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[d.value?(v(),p("svg",Ue,[...s[11]||(s[11]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):y("",!0),B(" "+o(d.value?"Updating...":"Update Status"),1)],8,Ge)])]),e("div",He,[s[16]||(s[16]=w('<div class="flex items-center space-x-3 mb-5"><div class="p-2 bg-gradient-to-br from-cyan-500 to-cyan-600 rounded-lg"><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div><h3 class="text-lg font-semibold text-slate-900">Customer</h3></div>',1)),e("div",Je,[e("div",Ke,o(((_=(x=t.value.userId)==null?void 0:x.firstName)==null?void 0:_.charAt(0))||"C"),1),e("div",qe,[e("div",We,o((A=t.value.userId)==null?void 0:A.firstName)+" "+o((M=t.value.userId)==null?void 0:M.lastName),1),s[13]||(s[13]=e("div",{class:"text-xs text-slate-500"},"Customer",-1))])]),e("div",Ye,[e("div",Ze,[s[14]||(s[14]=e("svg",{class:"w-4 h-4 text-slate-400 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),e("span",Qe,o((L=t.value.userId)==null?void 0:L.email),1)]),e("div",Xe,[s[15]||(s[15]=e("svg",{class:"w-4 h-4 text-slate-400 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),e("span",et,o(((O=t.value.userId)==null?void 0:O.phone)||"N/A"),1)])])]),t.value.deliveryAddress?(v(),p("div",tt,[s[17]||(s[17]=w('<div class="flex items-center space-x-3 mb-5"><div class="p-2 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-lg"><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></div><h3 class="text-lg font-semibold text-slate-900">Delivery Address</h3></div>',1)),e("div",st,[e("p",ot,o(t.value.deliveryAddress.street),1),e("p",rt,o(t.value.deliveryAddress.city)+", "+o(t.value.deliveryAddress.state),1),e("p",at,o(t.value.deliveryAddress.country),1)])])):y("",!0),t.value.pickupLocationSnapshot?(v(),p("div",lt,[s[23]||(s[23]=w('<div class="flex items-center space-x-3 mb-5"><div class="p-2 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-lg"><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg></div><h3 class="text-lg font-semibold text-slate-900">Pickup Location</h3></div>',1)),e("div",it,[e("div",null,[s[18]||(s[18]=e("p",{class:"text-xs text-slate-500 uppercase font-bold tracking-wider"},"Name",-1)),e("p",nt,o(t.value.pickupLocationSnapshot.name),1)]),e("div",null,[s[19]||(s[19]=e("p",{class:"text-xs text-slate-500 uppercase font-bold tracking-wider"},"Address",-1)),e("p",dt,o(t.value.pickupLocationSnapshot.address.street),1),e("p",ct,o(t.value.pickupLocationSnapshot.address.city)+", "+o(t.value.pickupLocationSnapshot.address.state),1)]),t.value.pickupLocationSnapshot.contact?(v(),p("div",ut,[s[22]||(s[22]=e("p",{class:"text-xs text-slate-500 uppercase font-bold tracking-wider"},"Contact",-1)),e("div",pt,[s[20]||(s[20]=e("svg",{class:"w-3.5 h-3.5 text-slate-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),e("p",vt,o(t.value.pickupLocationSnapshot.contact.name),1)]),e("div",mt,[s[21]||(s[21]=e("svg",{class:"w-3.5 h-3.5 text-slate-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),e("p",xt,o(t.value.pickupLocationSnapshot.contact.phone),1)])])):y("",!0)])])):y("",!0)])])])):(v(),p("div",ht,[...s[24]||(s[24]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-primary-500 border-t-transparent"},null,-1),e("p",{class:"mt-4 text-sm text-slate-500"},"Loading order details...",-1)])]))}}});typeof E=="function"&&E(gt);export{gt as default};
