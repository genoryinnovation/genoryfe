import{d as O,r as c,o as U,a,j as r,b as e,e as p,F as k,f as C,t as l,n as g,s as j,v as A,y as N}from"./index-5jFCLG0b.js";import{P}from"./partner-portal.service-BUr-YCxR.js";import"./api-Cc7xRAfh.js";const V={class:"space-y-6"},B={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},E={class:"text-sm font-medium text-slate-500"},F={class:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden relative"},M={key:0,class:"absolute inset-0 bg-white/50 backdrop-blur-[2px] flex items-center justify-center z-10"},L={class:"w-full text-left border-collapse"},T={class:"divide-y divide-slate-200"},$={key:0},q={class:"px-6 py-4 font-medium text-slate-900"},H={class:"px-6 py-4"},G={class:"text-slate-900 font-medium"},J={class:"text-xs text-slate-500"},K={class:"px-6 py-4 font-bold text-slate-900"},Q={class:"px-6 py-4 text-sm text-slate-500"},W={class:"px-6 py-4"},X={class:"px-6 py-4"},Y={class:"flex space-x-2"},Z=["onClick"],ee=["onClick"],te={key:0,class:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},se={class:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden"},oe={class:"p-6 border-b border-slate-100"},le={class:"text-xl font-bold text-slate-900"},ae={class:"p-6 space-y-4"},re={class:"text-slate-600"},ne={key:0,class:"space-y-1"},de={class:"space-y-1"},ie={class:"pt-4 flex space-x-3"},ce=["disabled"],ue=O({__name:"index",setup(pe){const u=c([]),n=c(!0),v=c([{label:"Total Requests",value:"0",colorClass:"text-slate-900"},{label:"Pending",value:"0",colorClass:"text-amber-600"},{label:"Approved",value:"0",colorClass:"text-emerald-600"},{label:"Rejected",value:"0",colorClass:"text-rose-600"}]),x=c(!1),d=c("approve"),f=c(null),m=c(""),b=c(""),h=async()=>{try{n.value=!0;const o=await P.getOrderRequests();u.value=o.requests;const s=u.value.filter(i=>i.status==="pending").length,t=u.value.filter(i=>i.status==="approved").length,y=u.value.filter(i=>i.status==="rejected").length;v.value[0].value=o.total.toString(),v.value[1].value=s.toString(),v.value[2].value=t.toString(),v.value[3].value=y.toString()}catch(o){console.error("Failed to fetch requests",o)}finally{n.value=!1}},S=o=>{switch(o){case"pending":return"bg-amber-100 text-amber-800";case"approved":return"bg-emerald-100 text-emerald-800";case"rejected":return"bg-rose-100 text-rose-800";default:return"bg-slate-100 text-slate-800"}},R=o=>{f.value=o,d.value="approve",m.value="",b.value="",x.value=!0},I=o=>{f.value=o,d.value="reject",m.value="",b.value="",x.value=!0},z=async()=>{var o,s;if(f.value)try{n.value=!0,await P.processOrder({requestId:f.value._id,action:d.value,pin:m.value,notes:b.value}),x.value=!1,await h()}catch(t){alert(((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to process request")}finally{n.value=!1}};return U(h),(o,s)=>(r(),a("div",V,[s[9]||(s[9]=e("div",{class:"flex justify-between items-center"},[e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-900"},"Employee Orders"),e("p",{class:"text-slate-500"},"Track and approve food and grocery orders.")])],-1)),e("div",B,[(r(!0),a(k,null,C(v.value,t=>(r(),a("div",{key:t.label,class:"bg-white p-6 rounded-xl shadow-sm border border-slate-200"},[e("p",E,l(t.label),1),e("p",{class:g(["text-2xl font-bold mt-1",t.colorClass])},l(t.value),3)]))),128))]),e("div",F,[n.value?(r(),a("div",M,[...s[3]||(s[3]=[e("svg",{class:"animate-spin h-8 w-8 text-primary-600",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):p("",!0),e("table",L,[s[6]||(s[6]=e("thead",{class:"bg-slate-50 border-b border-slate-200"},[e("tr",null,[e("th",{class:"px-6 py-4 text-sm font-semibold text-slate-600"},"Order #"),e("th",{class:"px-6 py-4 text-sm font-semibold text-slate-600"},"Employee"),e("th",{class:"px-6 py-4 text-sm font-semibold text-slate-600"},"Amount"),e("th",{class:"px-6 py-4 text-sm font-semibold text-slate-600"},"Date"),e("th",{class:"px-6 py-4 text-sm font-semibold text-slate-600"},"Status"),e("th",{class:"px-6 py-4 text-sm font-semibold text-slate-600"},"Actions")])],-1)),e("tbody",T,[u.value.length===0&&!n.value?(r(),a("tr",$,[...s[4]||(s[4]=[e("td",{colspan:"6",class:"px-6 py-12 text-center text-slate-500"},"No order requests found.",-1)])])):p("",!0),(r(!0),a(k,null,C(u.value,t=>{var y,i,_,w;return r(),a("tr",{key:t._id,class:"hover:bg-slate-50 transition-colors"},[e("td",q,l(((y=t.orderId)==null?void 0:y.orderNumber)||"N/A"),1),e("td",H,[e("p",G,l((i=t.requestingUserId)==null?void 0:i.firstName)+" "+l((_=t.requestingUserId)==null?void 0:_.lastName),1),e("p",J,l((w=t.requestingUserId)==null?void 0:w.email),1)]),e("td",K,"₦"+l(t.amount.toLocaleString()),1),e("td",Q,l(new Date(t.createdAt).toLocaleDateString()),1),e("td",W,[e("span",{class:g(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",S(t.status)])},l(t.status),3)]),e("td",X,[e("div",Y,[t.status==="pending"?(r(),a("button",{key:0,class:"px-3 py-1 bg-primary-600 text-white rounded-lg text-sm hover:bg-primary-700 transition-colors",onClick:D=>R(t)}," Approve ",8,Z)):p("",!0),t.status==="pending"?(r(),a("button",{key:1,class:"px-3 py-1 bg-white border border-rose-200 text-rose-600 rounded-lg text-sm hover:bg-rose-50 transition-colors",onClick:D=>I(t)}," Reject ",8,ee)):p("",!0),s[5]||(s[5]=e("button",{class:"px-3 py-1 border border-slate-200 rounded-lg text-sm hover:bg-slate-50 transition-colors"}," Details ",-1))])])])}),128))])])]),x.value?(r(),a("div",te,[e("div",se,[e("div",oe,[e("h3",le,l(d.value==="approve"?"Approve":"Reject")+" Order",1)]),e("div",ae,[e("p",re,l(d.value==="approve"?"Enter the company approval PIN to confirm this payment.":"Please provide a reason for rejecting this order request."),1),d.value==="approve"?(r(),a("div",ne,[s[7]||(s[7]=e("label",{class:"text-sm font-medium text-slate-700"},"Approval PIN",-1)),j(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),type:"password",maxlength:"6",placeholder:"••••••",class:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none text-center text-2xl tracking-widest",autofocus:""},null,512),[[A,m.value]])])):p("",!0),e("div",de,[s[8]||(s[8]=e("label",{class:"text-sm font-medium text-slate-700"},"Internal Notes (Optional)",-1)),j(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=t=>b.value=t),rows:"3",class:"w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none resize-none",placeholder:"Add any comments here..."},null,512),[[A,b.value]])]),e("div",ie,[e("button",{onClick:s[2]||(s[2]=t=>x.value=!1),class:"flex-1 py-3 border border-slate-200 text-slate-700 font-bold rounded-xl hover:bg-slate-50 transition-colors"}," Cancel "),e("button",{onClick:z,disabled:n.value,class:g(["flex-1 py-3 text-white font-bold rounded-xl transition-all",d.value==="approve"?"bg-primary-600 hover:bg-primary-700":"bg-rose-600 hover:bg-rose-700"])},l(n.value?"Processing...":d.value==="approve"?"Confirm Approval":"Confirm Rejection"),11,ce)])])])])):p("",!0)]))}});typeof N=="function"&&N(ue);export{ue as default};
