import{d as H,k as Q,r,o as Y,i as G,a as n,j as d,b as e,h as E,w as R,F as D,n as u,t as l,e as F,p as f,z as _,A as J,f as K,q as h,E as W,C as O}from"./index-DPa4r9b9.js";import{P as k}from"./partner-portal.service-D36OMrJc.js";import"./api-4GkiaaGr.js";const X={class:"space-y-6"},Z={class:"flex justify-between items-center"},ee={class:"flex items-center space-x-4"},te={key:0,class:"flex flex-col items-center justify-center py-24 bg-white rounded-3xl border border-slate-200 shadow-sm"},se={class:"flex space-x-6 mb-6 overflow-x-auto pb-2 scrollbar-hide"},le={key:0,class:"space-y-6"},oe={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},ae={class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm"},ie={class:"text-3xl font-black italic text-slate-900"},re={class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm"},ne={class:"text-3xl font-black italic text-slate-900"},de={class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm"},pe={class:"text-3xl font-black italic text-slate-900"},ue={class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm"},ce={class:"mt-1"},ve={class:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden"},xe={class:"p-8 border-b border-slate-100 flex flex-col md:flex-row md:items-center justify-between gap-4"},be={class:"flex items-center space-x-3"},me={class:"relative"},ge={class:"overflow-x-auto"},fe={class:"w-full text-left"},he={class:"divide-y divide-slate-100"},ye={key:0,class:"hover:bg-slate-50/50 transition-colors"},we={class:"px-8 py-4"},_e={class:"text-slate-900 font-bold"},ke={class:"text-[10px] text-slate-400 font-medium uppercase tracking-tighter"},Se={class:"px-8 py-4"},Ae={class:"text-slate-900 font-black italic"},Ce={class:"px-8 py-4"},Le={class:"px-8 py-4 text-right"},qe={class:"text-xs text-slate-500 font-medium"},Me={class:"text-[10px] text-slate-400"},Te={key:0,class:"px-8 py-4 bg-slate-50 border-t border-slate-100 flex items-center justify-between font-bold"},je={class:"text-sm text-slate-500"},Ne={class:"text-slate-900"},Pe={class:"text-slate-900"},Ve={class:"text-slate-900"},Ee={class:"flex space-x-2"},Re=["disabled"],De=["disabled"],Fe={key:1,class:"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden p-8"},Oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Be={class:"space-y-2"},Ue={class:"space-y-2"},ze={class:"space-y-2"},$e={class:"space-y-2"},Ie={class:"flex items-center space-x-4 h-[50px]"},He={class:"text-sm font-bold text-slate-600"},Qe={class:"space-y-2"},Ye={class:"flex items-center space-x-4 h-[50px]"},Ge=["disabled"],Je={class:"pt-6 border-t border-slate-100 flex justify-end"},Ke=["disabled"],We={key:0},Xe={key:1},Ze={key:2,class:"py-24 text-center bg-rose-50 rounded-3xl border border-rose-100"},et=H({__name:"[id]",setup(tt){const y=Q().params.id,b=r(null),S=r([]),T=r(0),A=r(!0),w=r(!1),C=r(!1),x=r("overview"),L=r(""),q=r(""),o=r(null),M=r(null),c=r("active"),a=r({orderThreshold:2e4,monthlySpendLimit:0,monthlyRequestsLimit:0,requiresApproval:!0}),j=r(0),m=async(i=1)=>{var t,g;try{i===1&&(A.value=!0);const[p,v]=await Promise.all([k.getEmployeeDetails(y),k.getEmployeeActivity(y,{page:i,limit:10,search:L.value,status:q.value})]);b.value=p,S.value=v.data||[],o.value=v.meta,T.value=((t=v.meta)==null?void 0:t.total)||0,j.value=((g=v.meta)==null?void 0:g.lifetimeSpend)||0,p.membership&&(c.value=p.membership.status||"active",p.membership.settings&&(a.value={...a.value,...p.membership.settings}))}catch(p){console.error("Failed to fetch employee details",p)}finally{A.value=!1}},N=i=>{m(i)},B=()=>{M.value&&clearTimeout(M.value),M.value=setTimeout(()=>{m(1)},500)},U=()=>{m(1)},z=i=>{switch(i){case"pending":return"bg-amber-100 text-amber-600";case"approved":return"bg-emerald-100 text-emerald-600";case"rejected":return"bg-rose-100 text-rose-600";default:return"bg-slate-100 text-slate-600"}},$=async()=>{try{w.value=!0,await k.updateEmployeeSettings(y,a.value),await m(),x.value="overview"}catch(i){console.error("Failed to save settings",i)}finally{w.value=!1}},I=async()=>{try{C.value=!0;const i=c.value==="active"?"suspended":"active";await k.toggleEmployeeMembershipStatus(y,i),c.value=i}catch(i){console.error("Failed to toggle status",i)}finally{C.value=!1}};return Y(m),(i,t)=>{var p,v,P;const g=G("router-link");return d(),n("div",X,[e("div",Z,[e("div",ee,[E(g,{to:"/partner/employees",class:"p-2 bg-white border border-slate-200 rounded-xl text-slate-400 hover:text-slate-600 hover:bg-slate-50 transition-all"},{default:R(()=>[...t[10]||(t[10]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),t[11]||(t[11]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-900"},"Employee Overview"),e("p",{class:"text-slate-500 text-sm"},"View profile and order history for this employee.")],-1))])]),A.value?(d(),n("div",te,[...t[12]||(t[12]=[e("svg",{class:"animate-spin h-12 w-12 text-primary-600",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("p",{class:"mt-4 text-slate-400 font-medium"},"Loading employee details...",-1)])])):b.value?(d(),n(D,{key:1},[e("div",se,[e("button",{onClick:t[0]||(t[0]=s=>x.value="overview"),class:u(["px-6 py-2.5 rounded-xl font-bold text-sm transition-all whitespace-nowrap",x.value==="overview"?"bg-primary-600 text-white shadow-lg shadow-primary-500/25":"bg-white text-slate-500 hover:bg-slate-50"])}," Overview ",2),e("button",{onClick:t[1]||(t[1]=s=>x.value="settings"),class:u(["px-6 py-2.5 rounded-xl font-bold text-sm transition-all whitespace-nowrap",x.value==="settings"?"bg-primary-600 text-white shadow-lg shadow-primary-500/25":"bg-white text-slate-500 hover:bg-slate-50"])}," Company Settings ",2)]),x.value==="overview"?(d(),n("div",le,[e("div",oe,[e("div",ae,[t[13]||(t[13]=e("p",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1"},"Total Requests",-1)),e("p",ie,l(T.value),1)]),e("div",re,[t[14]||(t[14]=e("p",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1"},"Lifetime Spending",-1)),e("p",ne,"₦"+l(j.value.toLocaleString()),1)]),e("div",de,[t[15]||(t[15]=e("p",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1"},"Single Order Limit",-1)),e("p",pe,"₦"+l(((P=(v=(p=b.value.membership)==null?void 0:p.settings)==null?void 0:v.orderThreshold)==null?void 0:P.toLocaleString())||"0"),1)]),e("div",ue,[t[16]||(t[16]=e("p",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1"},"Account Status",-1)),e("div",ce,[e("span",{class:u(["px-3 py-1 font-bold rounded-lg uppercase text-[10px]",b.value.isActive?"bg-emerald-50 text-emerald-600":"bg-rose-50 text-rose-600"])},l(b.value.isActive?"Active":"Inactive"),3)])])]),e("div",ve,[e("div",xe,[t[19]||(t[19]=e("h3",{class:"text-xl font-black text-slate-900 italic tracking-tight"},"Order Activity",-1)),e("div",be,[e("div",me,[f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>L.value=s),onInput:B,type:"text",placeholder:"Search orders...",class:"pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none w-64 transition-all text-sm"},null,544),[[_,L.value]]),t[17]||(t[17]=e("svg",{class:"w-4 h-4 text-slate-400 absolute left-3 top-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))]),f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>q.value=s),onChange:U,class:"px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none text-sm font-medium"},[...t[18]||(t[18]=[e("option",{value:""},"All Status",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1)])],544),[[J,q.value]])])]),e("div",ge,[e("table",fe,[t[21]||(t[21]=e("thead",null,[e("tr",{class:"bg-slate-50 border-b border-slate-100"},[e("th",{class:"px-8 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Order Info"),e("th",{class:"px-8 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Amount"),e("th",{class:"px-8 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest"},"Status"),e("th",{class:"px-8 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-right"},"Date")])],-1)),e("tbody",he,[S.value.length===0?(d(),n("tr",ye,[...t[20]||(t[20]=[e("td",{colspan:"4",class:"px-8 py-12 text-center text-slate-400 font-medium"}," No order history found matching your criteria. ",-1)])])):F("",!0),(d(!0),n(D,null,K(S.value,s=>{var V;return d(),n("tr",{key:s._id,class:"hover:bg-slate-50/50 transition-colors group"},[e("td",we,[e("p",_e,l(((V=s.order)==null?void 0:V.orderNumber)||"Pending Order"),1),e("p",ke,"REF: "+l(s._id.slice(-8).toUpperCase()),1)]),e("td",Se,[e("p",Ae,"₦"+l(s.amount.toLocaleString()),1)]),e("td",Ce,[e("span",{class:u(["px-2 py-1 rounded text-[10px] font-bold uppercase tracking-tighter",z(s.status)])},l(s.status),3)]),e("td",Le,[e("p",qe,l(new Date(s.createdAt).toLocaleDateString()),1),e("p",Me,l(new Date(s.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)])])}),128))])])]),o.value&&o.value.pages>1?(d(),n("div",Te,[e("span",je,[t[22]||(t[22]=h(" Showing ",-1)),e("span",Ne,l(o.value.page*o.value.limit-o.value.limit+1),1),t[23]||(t[23]=h(" to ",-1)),e("span",Pe,l(Math.min(o.value.page*o.value.limit,o.value.total)),1),t[24]||(t[24]=h(" of ",-1)),e("span",Ve,l(o.value.total),1),t[25]||(t[25]=h(" entries ",-1))]),e("div",Ee,[e("button",{onClick:t[4]||(t[4]=s=>N(o.value.page-1)),disabled:!o.value.hasPrevPage,class:"px-3 py-1 border border-slate-200 rounded-lg bg-white hover:bg-slate-50 disabled:opacity-50 transition-colors text-xs"}," Prev ",8,Re),e("button",{onClick:t[5]||(t[5]=s=>N(o.value.page+1)),disabled:!o.value.hasNextPage,class:"px-3 py-1 border border-slate-200 rounded-lg bg-white hover:bg-slate-50 disabled:opacity-50 transition-colors text-xs"}," Next ",8,De)])])):F("",!0)])])):(d(),n("div",Fe,[t[31]||(t[31]=e("h3",{class:"text-xl font-black text-slate-900 italic tracking-tight mb-8"},"Membership Settings",-1)),e("form",{onSubmit:W($,["prevent"]),class:"space-y-6"},[e("div",Oe,[e("div",Be,[t[26]||(t[26]=e("label",{class:"text-xs font-bold text-slate-400 uppercase tracking-widest"},"Single Order Limit (₦)",-1)),f(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.orderThreshold=s),type:"number",class:"w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-2xl focus:ring-2 focus:ring-primary-500 outline-none font-bold"},null,512),[[_,a.value.orderThreshold]])]),e("div",Ue,[t[27]||(t[27]=e("label",{class:"text-xs font-bold text-slate-400 uppercase tracking-widest"},"Monthly Spend Limit (₦)",-1)),f(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.monthlySpendLimit=s),type:"number",placeholder:"No limit",class:"w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-2xl focus:ring-2 focus:ring-primary-500 outline-none font-bold"},null,512),[[_,a.value.monthlySpendLimit]])]),e("div",ze,[t[28]||(t[28]=e("label",{class:"text-xs font-bold text-slate-400 uppercase tracking-widest"},"Monthly Requests Limit",-1)),f(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.monthlyRequestsLimit=s),type:"number",placeholder:"No limit",class:"w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-2xl focus:ring-2 focus:ring-primary-500 outline-none font-bold"},null,512),[[_,a.value.monthlyRequestsLimit]])]),e("div",$e,[t[29]||(t[29]=e("label",{class:"text-xs font-bold text-slate-400 uppercase tracking-widest"},"Requires Approval",-1)),e("div",Ie,[e("button",{type:"button",onClick:t[9]||(t[9]=s=>a.value.requiresApproval=!a.value.requiresApproval),class:u(["w-12 h-6 rounded-full transition-all relative",a.value.requiresApproval?"bg-primary-600":"bg-slate-200"])},[e("div",{class:u(["w-4 h-4 bg-white rounded-full absolute top-1 transition-all",a.value.requiresApproval?"right-1":"left-1"])},null,2)],2),e("span",He,l(a.value.requiresApproval?"Yes":"No"),1)])]),e("div",Qe,[t[30]||(t[30]=e("label",{class:"text-xs font-bold text-slate-400 uppercase tracking-widest"},"Membership Status",-1)),e("div",Ye,[e("button",{type:"button",onClick:I,disabled:C.value,class:u(["w-12 h-6 rounded-full transition-all relative",c.value==="active"?"bg-emerald-500":"bg-rose-500"])},[e("div",{class:u(["w-4 h-4 bg-white rounded-full absolute top-1 transition-all",c.value==="active"?"right-1":"left-1"])},null,2)],10,Ge),e("span",{class:u(["text-sm font-bold",c.value==="active"?"text-emerald-600":"text-rose-600"])},l(c.value==="active"?"Active":"Suspended"),3)])])]),e("div",Je,[e("button",{type:"submit",disabled:w.value,class:"px-8 py-3 bg-primary-600 text-white font-black rounded-2xl hover:bg-primary-700 transition-all shadow-lg shadow-primary-500/25 disabled:opacity-50 flex items-center space-x-2"},[w.value?(d(),n("span",We,"Updating...")):(d(),n("span",Xe,"Save Settings"))],8,Ke)])],32)]))],64)):(d(),n("div",Ze,[t[33]||(t[33]=e("p",{class:"text-rose-600 font-bold"},"Employee not found or access denied.",-1)),E(g,{to:"/partner/employees",class:"mt-4 inline-block text-primary-600 font-bold underline"},{default:R(()=>[...t[32]||(t[32]=[h("Back to Employees",-1)])]),_:1})]))])}}});typeof O=="function"&&O(et);export{et as default};
