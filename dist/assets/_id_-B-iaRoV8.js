import{d as D,r as d,f as W,c as l,a as t,b as y,s as A,t as o,F as B,l as F,e as b,p as P,v as T,q as R,u as V,o as n,n as U,k as j}from"./index-C4KQTk6n.js";import{U as G}from"./user.service-6_qoh3l6.js";import{W as w}from"./wallet.service-VSoGEOlu.js";import"./api-Csnh6SWI.js";const K={key:0},M={class:"flex justify-between items-center mb-6"},$={class:"bg-white shadow overflow-hidden sm:rounded-lg"},z={class:"px-4 py-5 sm:px-6"},E={class:"text-lg leading-6 font-medium text-gray-900"},q={class:"border-t border-gray-200"},J={class:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},H={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},O={class:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},Q={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},X={class:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},Y={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Z={class:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},I={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},tt={class:"mt-8"},et={class:"flex justify-between items-center mb-4"},st={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 mb-6"},ot={class:"bg-white overflow-hidden shadow rounded-lg"},at={class:"px-4 py-5 sm:p-6"},lt={class:"mt-1 text-3xl font-semibold text-gray-900"},nt={key:0,class:"mt-1 text-sm text-gray-500"},rt={class:"bg-white overflow-hidden shadow rounded-lg"},dt={class:"px-4 py-5 sm:p-6"},it={class:"mt-1 text-3xl font-semibold text-purple-600"},mt={key:0,class:"mt-1 text-sm text-gray-500"},ct={class:"bg-white shadow overflow-hidden sm:rounded-lg"},ut={class:"min-w-full divide-y divide-gray-200"},pt={class:"bg-white divide-y divide-gray-200"},xt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},gt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 capitalize"},yt={key:0},ft={key:1},vt={class:"px-6 py-4 whitespace-nowrap"},bt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},wt={key:0},ht={key:0,class:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},_t={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},kt={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Nt={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Tt={class:"sm:flex sm:items-start"},Ut={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},Lt={class:"mt-2"},St={class:"mb-4"},Ct={class:"mb-4"},Dt={class:"mb-4"},Wt={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},At=["disabled"],Bt={key:1,class:"text-center py-12"},Gt=D({__name:"[id]",setup(Ft){const f=R(),L=V(),r=d(null),i=d(null),v=d([]),m=d(!1),c=d(0),u=d("naira"),p=d(""),x=d(!1),S=async()=>{try{const a=f.params.id,e=await G.getUser(a);r.value=e.data,await h(a)}catch(a){console.error("Failed to fetch user",a)}},h=async a=>{try{const[e,g]=await Promise.all([w.getWallet(a),w.getTransactions(a)]);i.value=e.data,v.value=g.data.transactions}catch(e){console.error("Failed to fetch wallet data",e)}},C=async()=>{if(c.value<=0){alert("Please enter a valid amount");return}x.value=!0;try{await w.topUpWallet(f.params.id,c.value,u.value,p.value),alert("Wallet topped up successfully"),m.value=!1,c.value=0,u.value="naira",p.value="",await h(f.params.id)}catch(a){console.error("Failed to top up wallet",a),alert("Failed to top up wallet")}finally{x.value=!1}};return W(()=>{S()}),(a,e)=>{var g,_,k,N;return r.value?(n(),l("div",K,[t("div",M,[e[7]||(e[7]=t("h1",{class:"text-2xl font-semibold text-gray-900"}," User Details ",-1)),t("button",{onClick:e[0]||(e[0]=s=>A(L).back()),class:"text-gray-600 hover:text-gray-900"}," Back to Users ")]),t("div",$,[t("div",z,[t("h3",E,o(r.value.firstName)+" "+o(r.value.lastName),1),e[8]||(e[8]=t("p",{class:"mt-1 max-w-2xl text-sm text-gray-500"}," Personal details and application. ",-1))]),t("div",q,[t("dl",null,[t("div",J,[e[9]||(e[9]=t("dt",{class:"text-sm font-medium text-gray-500"},"Full name",-1)),t("dd",H,o(r.value.firstName)+" "+o(r.value.lastName),1)]),t("div",O,[e[10]||(e[10]=t("dt",{class:"text-sm font-medium text-gray-500"},"Email address",-1)),t("dd",Q,o(r.value.email),1)]),t("div",X,[e[11]||(e[11]=t("dt",{class:"text-sm font-medium text-gray-500"},"Phone number",-1)),t("dd",Y,o(r.value.phone||"N/A"),1)]),t("div",Z,[e[12]||(e[12]=t("dt",{class:"text-sm font-medium text-gray-500"},"Joined",-1)),t("dd",I,o(new Date(r.value.createdAt).toLocaleDateString()),1)])])])]),t("div",tt,[t("div",et,[e[13]||(e[13]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Wallet",-1)),t("button",{onClick:e[1]||(e[1]=s=>m.value=!0),class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700"}," Top Up Wallet ")]),t("div",st,[t("div",ot,[t("div",at,[e[14]||(e[14]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Naira Balance",-1)),t("dd",lt,"NGN "+o((((g=i.value)==null?void 0:g.nairaBalance)||0).toLocaleString()),1),((_=i.value)==null?void 0:_.nairaLocked)>0?(n(),l("dd",nt,"Locked: NGN "+o(i.value.nairaLocked.toLocaleString()),1)):y("",!0)])]),t("div",rt,[t("div",dt,[e[15]||(e[15]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Token Balance",-1)),t("dd",it,o((((k=i.value)==null?void 0:k.tokenBalance)||0).toLocaleString())+" TKN",1),((N=i.value)==null?void 0:N.tokenLocked)>0?(n(),l("dd",mt,"Locked: "+o(i.value.tokenLocked.toLocaleString())+" TKN",1)):y("",!0)])])]),t("div",ct,[e[18]||(e[18]=t("div",{class:"px-4 py-5 sm:px-6"},[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," Recent Transactions ")],-1)),t("table",ut,[e[17]||(e[17]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Type "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Amount "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Reference ")])],-1)),t("tbody",pt,[(n(!0),l(B,null,F(v.value,s=>(n(),l("tr",{key:s._id},[t("td",xt,o(new Date(s.createdAt).toLocaleDateString()),1),t("td",gt,o(s.transactionType)+" ("+o(s.reason.replace(/_/g," "))+") ",1),t("td",{class:U(["px-6 py-4 whitespace-nowrap text-sm font-medium",s.transactionType==="credit"?"text-green-600":"text-red-600"])},[j(o(s.transactionType==="credit"?"+":"-")+" ",1),s.amountType==="token"?(n(),l("span",yt,o((s.tokenAmount||0).toLocaleString())+" TKN",1)):(n(),l("span",ft,"NGN "+o((s.nairaAmount||0).toLocaleString()),1))],2),t("td",vt,[t("span",{class:U(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800":s.status==="completed","bg-yellow-100 text-yellow-800":s.status==="pending","bg-red-100 text-red-800":s.status==="failed"}])},o(s.status),3)]),t("td",bt,o(s.reference),1)]))),128)),v.value.length===0?(n(),l("tr",wt,[...e[16]||(e[16]=[t("td",{colspan:"5",class:"px-6 py-4 text-center text-sm text-gray-500"}," No transactions found. ",-1)])])):y("",!0)])])])]),m.value?(n(),l("div",ht,[t("div",_t,[t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:e[2]||(e[2]=s=>m.value=!1)}),e[24]||(e[24]=t("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),t("div",kt,[t("div",Nt,[t("div",Tt,[t("div",Ut,[e[23]||(e[23]=t("h3",{class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"}," Top Up Wallet ",-1)),t("div",Lt,[t("div",St,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Currency",-1)),b(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>u.value=s),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},[...e[19]||(e[19]=[t("option",{value:"naira"},"Naira (NGN)",-1),t("option",{value:"token"},"Token (TKN)",-1)])],512),[[P,u.value]])]),t("div",Ct,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700"},"Amount",-1)),b(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>c.value=s),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[T,c.value]])]),t("div",Dt,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),b(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>p.value=s),rows:"3",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[T,p.value]])])])])])]),t("div",Wt,[t("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:C,disabled:x.value},o(x.value?"Processing...":"Top Up"),9,At),t("button",{type:"button",class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:e[6]||(e[6]=s=>m.value=!1)}," Cancel ")])])])])):y("",!0)])):(n(),l("div",Bt,[...e[25]||(e[25]=[t("p",{class:"text-gray-500"},"Loading user details...",-1)])]))}}});export{Gt as default};
