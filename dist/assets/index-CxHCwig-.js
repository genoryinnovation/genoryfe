import{d as B,r,o as R,i as D,a as l,j as a,b as e,e as c,p as g,z as h,F as P,f as S,h as q,w as L,t as n,q as w,n as U,E,C as z}from"./index-DPa4r9b9.js";import{P as k}from"./partner-portal.service-D36OMrJc.js";import"./api-4GkiaaGr.js";const H={class:"space-y-6"},J={class:"flex justify-between items-center"},Q={class:"flex space-x-3"},W={class:"relative"},G={class:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden relative min-h-[400px]"},K={key:0,class:"absolute inset-0 bg-white/50 backdrop-blur-[2px] flex items-center justify-center z-10 transition-all"},O={class:"w-full text-left"},X={class:"divide-y divide-slate-100"},Y={key:0},Z={class:"px-6 py-4"},ee={class:"w-9 h-9 bg-slate-100 rounded-full flex items-center justify-center font-bold text-slate-500 text-xs"},te={class:"font-bold text-slate-900"},se={class:"text-xs text-slate-500"},le={class:"px-6 py-4"},ae={class:"text-xs font-medium px-2 py-1 bg-slate-100 text-slate-600 rounded-md uppercase tracking-wider"},oe={class:"px-6 py-4"},ne={key:0,class:"flex items-center space-x-1"},ie={key:1,class:"flex items-center space-x-1"},re={key:2,class:"flex items-center space-x-1"},de={key:3,class:"flex items-center space-x-1"},ue={class:"text-xs font-medium text-slate-600"},ce={class:"px-6 py-4"},pe={class:"flex items-center justify-end space-x-2"},xe=["onClick","disabled"],ve=["onClick","disabled"],fe={class:"text-[10px] text-slate-400 font-medium ml-4"},me={key:1,class:"px-6 py-4 bg-slate-50 border-t border-slate-100 flex items-center justify-between font-bold"},be={class:"text-sm text-slate-500"},ye={class:"text-slate-900"},ge={class:"text-slate-900"},he={class:"text-slate-900"},we={class:"flex space-x-2"},ke=["disabled"],_e={class:"flex space-x-1"},Ce=["onClick"],Ne=["disabled"],Me={key:0,class:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Te={class:"bg-white rounded-3xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200"},je={class:"p-8 border-b border-slate-100 flex justify-between items-center"},Pe={key:0,class:"p-4 bg-rose-50 border border-rose-100 rounded-2xl text-rose-600 text-sm font-medium animate-in fade-in slide-in-from-top-2"},Se={key:1,class:"p-4 bg-emerald-50 border border-emerald-100 rounded-2xl text-emerald-600 text-sm font-medium animate-in fade-in slide-in-from-top-2"},ze={class:"grid grid-cols-2 gap-4"},Fe={class:"space-y-1"},Ve={class:"space-y-1"},Ae={class:"space-y-1"},Ie={class:"pt-4 flex space-x-3"},$e=["disabled"],Be={key:0},Re={key:1,class:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},De=B({__name:"index",setup(qe){const _=r([]),m=r(!0),b=r(!1),p=r(null),v=r(!1),y=r(""),f=r(""),C=r(""),o=r(null),N=r(null),u=r({firstName:"",lastName:"",email:""}),x=async(i=1)=>{try{m.value=!0;const t=await k.getTeam({page:i,limit:10,search:C.value});_.value=t.data,o.value=t.meta}catch(t){console.error("Failed to fetch team",t)}finally{m.value=!1}},F=()=>{N.value&&clearTimeout(N.value),N.value=setTimeout(()=>{x(1)},500)},M=i=>{x(i)},V=async()=>{var i,t;try{y.value="",f.value="",b.value=!0,await k.inviteTeamMember(u.value),f.value="Team member invited successfully!",await x(),setTimeout(()=>{v.value=!1,f.value="",u.value={firstName:"",lastName:"",email:""}},1500)}catch(d){console.error("Failed to invite team member",d),y.value=((t=(i=d.response)==null?void 0:i.data)==null?void 0:t.message)||"Failed to invite team member. Please try again."}finally{b.value=!1}},A=async i=>{var t,d;try{p.value=i,await k.resendTeamInvitation(i),await x()}catch(s){console.error("Failed to resend invitation",s),alert(((d=(t=s.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to resend invitation")}finally{p.value=null}},I=async i=>{var t,d;if(confirm("Are you sure you want to revoke this invitation? This member will lose all access."))try{p.value=i,await k.revokeTeamInvitation(i),await x()}catch(s){console.error("Failed to revoke invitation",s),alert(((d=(t=s.response)==null?void 0:t.data)==null?void 0:d.message)||"Failed to revoke invitation")}finally{p.value=null}};return R(x),(i,t)=>{const d=D("router-link");return a(),l("div",H,[e("div",J,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-900"},"Portal Access (Team)"),e("p",{class:"text-slate-500"},"Manage who has access to your company's partner portal.")],-1)),e("div",Q,[e("div",W,[g(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>C.value=s),onInput:F,type:"text",placeholder:"Search members...",class:"pl-10 pr-4 py-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none w-64 transition-all"},null,544),[[h,C.value]]),t[9]||(t[9]=e("svg",{class:"w-5 h-5 text-slate-400 absolute left-3 top-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))]),e("button",{onClick:t[1]||(t[1]=s=>v.value=!0),class:"px-6 py-2 bg-primary-600 text-white font-bold rounded-xl hover:bg-primary-700 transition-all shadow-lg shadow-primary-500/25"}," Invite Member ")])]),e("div",G,[m.value?(a(),l("div",K,[...t[11]||(t[11]=[e("svg",{class:"animate-spin h-10 w-10 text-primary-600",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):c("",!0),e("table",O,[t[17]||(t[17]=e("thead",null,[e("tr",{class:"bg-slate-50 border-b border-slate-100"},[e("th",{class:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider"},"Member"),e("th",{class:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider"},"Role"),e("th",{class:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right"},"Added")])],-1)),e("tbody",X,[_.value.length===0&&!m.value?(a(),l("tr",Y,[...t[12]||(t[12]=[e("td",{colspan:"4",class:"px-6 py-12 text-center text-slate-400"}," No team members found. Invite your first team member! ",-1)])])):c("",!0),(a(!0),l(P,null,S(_.value,s=>{var T,j;return a(),l("tr",{key:s._id,class:"hover:bg-slate-50/50 transition-colors group"},[e("td",Z,[q(d,{to:`/partner/team/${s._id}`,class:"flex items-center space-x-3 hover:opacity-80 transition-opacity"},{default:L(()=>[e("div",ee,n(s.firstName[0])+n(s.lastName[0]),1),e("div",null,[e("p",te,n(s.firstName)+" "+n(s.lastName),1),e("p",se,n(s.email),1)])]),_:2},1032,["to"])]),e("td",le,[e("span",ae,n(((T=s.role)==null?void 0:T.name)||"Staff"),1)]),e("td",oe,[s.status==="active"?(a(),l("span",ne,[...t[13]||(t[13]=[e("span",{class:"w-1.5 h-1.5 bg-emerald-500 rounded-full"},null,-1),e("span",{class:"text-xs font-medium text-emerald-600"},"Active",-1)])])):s.status==="pending"?(a(),l("span",ie,[...t[14]||(t[14]=[e("span",{class:"w-1.5 h-1.5 bg-amber-500 rounded-full animate-pulse"},null,-1),e("span",{class:"text-xs font-medium text-amber-600"},"Pending",-1)])])):s.status==="revoked"?(a(),l("span",re,[...t[15]||(t[15]=[e("span",{class:"w-1.5 h-1.5 bg-rose-500 rounded-full"},null,-1),e("span",{class:"text-xs font-medium text-rose-600"},"Revoked",-1)])])):(a(),l("span",de,[t[16]||(t[16]=e("span",{class:"w-1.5 h-1.5 bg-slate-500 rounded-full"},null,-1)),e("span",ue,n(s.isActive?"Active":"Inactive"),1)]))]),e("td",ce,[e("div",pe,[s.status==="pending"||s.status==="revoked"?(a(),l("button",{key:0,onClick:$=>A(s._id),disabled:p.value===s._id,class:"text-xs font-bold text-primary-600 hover:text-primary-700 disabled:opacity-50 transition-colors"},n(p.value===s._id?"Sending...":"Reinvite"),9,xe)):c("",!0),s.status!=="revoked"&&((j=s.role)==null?void 0:j.key)!=="partner"?(a(),l("button",{key:1,onClick:$=>I(s._id),disabled:p.value===s._id,class:"text-xs font-bold text-rose-600 hover:text-rose-700 disabled:opacity-50 transition-colors"}," Revoke ",8,ve)):c("",!0),e("p",fe,n(new Date(s.createdAt).toLocaleDateString()),1)])])])}),128))])]),o.value&&o.value.pages>1?(a(),l("div",me,[e("span",be,[t[18]||(t[18]=w(" Showing ",-1)),e("span",ye,n(o.value.page*o.value.limit-o.value.limit+1),1),t[19]||(t[19]=w(" to ",-1)),e("span",ge,n(Math.min(o.value.page*o.value.limit,o.value.total)),1),t[20]||(t[20]=w(" of ",-1)),e("span",he,n(o.value.total),1),t[21]||(t[21]=w(" entries ",-1))]),e("div",we,[e("button",{onClick:t[2]||(t[2]=s=>M(o.value.page-1)),disabled:!o.value.hasPrevPage,class:"px-3 py-1 border border-slate-200 rounded-lg bg-white hover:bg-slate-50 disabled:opacity-50 transition-colors"}," Prev ",8,ke),e("div",_e,[(a(!0),l(P,null,S(o.value.pages,s=>(a(),l("button",{key:s,onClick:T=>M(s),class:U(["px-3 py-1 border rounded-lg transition-colors",o.value.page===s?"bg-primary-600 text-white border-primary-600":"bg-white border-slate-200 hover:bg-slate-50"])},n(s),11,Ce))),128))]),e("button",{onClick:t[3]||(t[3]=s=>M(o.value.page+1)),disabled:!o.value.hasNextPage,class:"px-3 py-1 border border-slate-200 rounded-lg bg-white hover:bg-slate-50 disabled:opacity-50 transition-colors"}," Next ",8,Ne)])])):c("",!0)]),v.value?(a(),l("div",Me,[e("div",Te,[e("div",je,[t[23]||(t[23]=e("div",null,[e("h3",{class:"text-2xl font-black text-slate-900 italic"},"Invite Member"),e("p",{class:"text-slate-500 text-sm mt-1"},"Provide access to the portal for a staff member.")],-1)),e("button",{onClick:t[4]||(t[4]=s=>v.value=!1),class:"p-2 text-slate-400 hover:text-slate-600 transition-colors"},[...t[22]||(t[22]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:E(V,["prevent"]),class:"p-8 space-y-6"},[y.value?(a(),l("div",Pe,n(y.value),1)):c("",!0),f.value?(a(),l("div",Se,n(f.value),1)):c("",!0),e("div",ze,[e("div",Fe,[t[24]||(t[24]=e("label",{class:"text-xs font-bold text-slate-500 uppercase tracking-widest pl-1"},"First Name",-1)),g(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>u.value.firstName=s),type:"text",required:"",placeholder:"John",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary-500 outline-none transition-all"},null,512),[[h,u.value.firstName]])]),e("div",Ve,[t[25]||(t[25]=e("label",{class:"text-xs font-bold text-slate-500 uppercase tracking-widest pl-1"},"Last Name",-1)),g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>u.value.lastName=s),type:"text",required:"",placeholder:"Doe",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary-500 outline-none transition-all"},null,512),[[h,u.value.lastName]])])]),e("div",Ae,[t[26]||(t[26]=e("label",{class:"text-xs font-bold text-slate-500 uppercase tracking-widest pl-1"},"Work Email",-1)),g(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>u.value.email=s),type:"email",required:"",placeholder:"john.doe@company.com",class:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary-500 outline-none transition-all"},null,512),[[h,u.value.email]])]),e("div",Ie,[e("button",{type:"button",onClick:t[8]||(t[8]=s=>v.value=!1),class:"flex-1 py-4 border border-slate-200 text-slate-700 font-bold rounded-2xl hover:bg-slate-50 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:b.value,class:"flex-1 py-4 bg-slate-900 text-white font-bold rounded-2xl hover:bg-slate-800 transition-all shadow-xl shadow-slate-900/20 flex items-center justify-center space-x-2 disabled:opacity-50"},[b.value?(a(),l("svg",Re,[...t[27]||(t[27]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),l("span",Be,"Send Invitation"))],8,$e)])],32)])])):c("",!0)])}}});typeof z=="function"&&z(De);export{De as default};
