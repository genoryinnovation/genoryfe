import{d as ae,k as re,u as ne,r as i,c as ie,o as de,i as ue,a,j as r,b as e,e as u,h as ce,w as pe,q as xe,t as o,n as ve,F as J,f as Y,g as fe,p as N,z as j,G as me,N as be,C as W}from"./index-CVDPA8xH.js";import{P as X}from"./partner-portal.service-D36OMrJc.js";import"./api-4GkiaaGr.js";const he={class:"space-y-6 max-w-5xl mx-auto pb-12"},ge={class:"flex items-center space-x-4 mb-8"},ye={class:"text-slate-500 text-sm"},we={class:"font-bold text-slate-700"},ke={key:0,class:"flex flex-col items-center justify-center py-24 space-y-4"},_e={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500"},Ne={class:"lg:col-span-2 space-y-6"},je={class:"bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden"},Ce={class:"p-6 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center"},Re={class:"p-0"},Ae={class:"w-full text-left"},Pe={class:"divide-y divide-slate-50"},Ie={class:"px-8 py-5"},De={class:"flex items-center space-x-4"},Ve={class:"w-12 h-12 bg-slate-100 rounded-xl overflow-hidden flex-shrink-0"},qe=["src"],ze={key:1,class:"w-full h-full flex items-center justify-center text-slate-300"},Ee={class:"font-bold text-slate-900 group-hover:text-primary-600 transition-colors"},Oe={class:"text-xs text-slate-400"},Se={class:"px-8 py-5 text-center font-bold text-slate-700"},Be={class:"px-8 py-5 text-right font-black text-slate-900"},Me={class:"bg-slate-50/30 font-black"},Te={class:"px-8 py-6 text-right text-xl text-primary-600"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Le={class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm"},Ue={class:"space-y-4"},Ge={class:"text-sm font-bold text-slate-900 mt-1"},$e={class:"flex justify-between items-center"},He={class:"text-sm font-bold text-slate-900 mt-1"},Ke={class:"text-sm font-bold text-slate-900 mt-1"},Qe={class:"space-y-6"},Je={class:"bg-white p-8 rounded-3xl border border-slate-200 shadow-sm text-center"},Ye={class:"w-20 h-20 bg-primary-600 rounded-3xl mx-auto mb-4 flex items-center justify-center text-white text-2xl font-black shadow-xl shadow-primary-500/20"},We={class:"text-xl font-black text-slate-900 italic"},Xe={class:"text-sm text-slate-500 font-medium"},Ze={class:"mt-8 pt-8 border-t border-slate-100 grid grid-cols-2 gap-4 text-left"},et={class:"text-xs font-bold text-slate-900"},tt={class:"text-xs font-bold text-slate-900"},st={key:0,class:"bg-slate-900 p-8 rounded-3xl shadow-2xl shadow-slate-900/40 relative overflow-hidden group"},ot={class:"space-y-3"},lt={key:1,class:"bg-white p-8 rounded-3xl border border-slate-200 shadow-sm"},at={class:"flex items-center space-x-3 text-slate-500 mb-4"},rt={class:"text-xs font-black uppercase tracking-widest"},nt={class:"space-y-1"},it={class:"text-sm font-bold text-slate-900"},dt={key:0,class:"mt-4 p-4 bg-slate-50 rounded-2xl text-xs text-slate-600 italic"},ut={key:1,class:"mt-4 p-4 bg-rose-50 rounded-2xl text-xs text-rose-600 italic"},ct={key:2,class:"fixed inset-0 bg-slate-900/60 backdrop-blur-md flex items-center justify-center z-[100] p-4"},pt={class:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-sm overflow-hidden animate-in zoom-in duration-300"},xt={class:"p-10 text-center"},vt={key:0,class:"text-slate-500 text-sm mt-2"},ft={key:1,class:"text-slate-500 text-sm mt-2"},mt={key:2,class:"mt-4 p-3 bg-rose-50 border border-rose-100 rounded-2xl text-rose-600 text-xs font-bold animate-in fade-in slide-in-from-top-1"},bt={key:3,class:"mt-4 p-3 bg-emerald-50 border border-emerald-100 rounded-2xl text-emerald-600 text-xs font-bold animate-in fade-in slide-in-from-top-1"},ht={key:4,class:"mt-8 flex justify-center space-x-3"},gt=["onUpdate:modelValue","onInput","onKeydown"],yt={key:5,class:"mt-8 space-y-4 animate-in slide-in-from-bottom-4 duration-300"},wt={class:"mt-10 flex space-x-4"},kt=["disabled"],_t=ae({__name:"[id]",setup(Nt){const Z=re(),ee=ne(),s=i(null),w=i(!0),h=i(!1),k=i(""),f=i(""),c=i(""),d=i(!1),m=i(""),g=i(!1),_=i("approve"),x=i(["","","",""]),y=i([]),te=ie(()=>{if(!s.value)return"";switch(s.value.status){case"approved":return"bg-emerald-100 text-emerald-800";case"rejected":return"bg-rose-100 text-rose-800";default:return"bg-amber-100 text-amber-800"}}),C=async()=>{try{w.value=!0;const n=await X.getOrderRequest(Z.params.id);s.value=n}catch(n){console.error("Failed to fetch order request",n),alert("Failed to load order request details."),ee.push("/partner/orders")}finally{w.value=!1}},R=n=>{_.value=n,x.value=["","","",""],m.value="",d.value=!1,f.value="",c.value="",g.value=!0,be(()=>{var t;return(t=y.value[0])==null?void 0:t.focus()})},se=(n,t)=>{var b;t.target.value&&n<3&&((b=y.value[n+1])==null||b.focus())},oe=n=>{var t;!x.value[n]&&n>0&&((t=y.value[n-1])==null||t.focus())},le=async()=>{var n,t;try{if(f.value="",c.value="",h.value=!0,(await X.processOrder({requestId:s.value._id,action:_.value,pin:x.value.join(""),otp:m.value,notes:k.value})).requireOtp){d.value=!0,c.value="PIN verified. Please enter the OTP sent to your email.";return}c.value=`Order ${_.value==="approve"?"approved":"rejected"} successfully!`,await C(),setTimeout(()=>{g.value=!1,c.value=""},1500)}catch(v){console.error("Failed to process order",v),f.value=((t=(n=v.response)==null?void 0:n.data)==null?void 0:t.message)||"Action failed. Please verify your PIN."}finally{h.value=!1}};return de(C),(n,t)=>{var b,A,P,I,D,V,q,z,E,O,S,B,M,T,F,L,U,G,$,H;const v=ue("router-link");return r(),a("div",he,[e("div",ge,[ce(v,{to:"/partner/orders",class:"p-2 hover:bg-white rounded-xl transition-colors text-slate-400 hover:text-slate-900 border border-transparent hover:border-slate-200"},{default:pe(()=>[...t[5]||(t[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),e("div",null,[t[7]||(t[7]=e("h1",{class:"text-2xl font-black text-slate-900 italic uppercase tracking-tight"},"Order Request Detail",-1)),e("p",ye,[t[6]||(t[6]=xe("Reviewing request ",-1)),e("span",we,"#"+o(((A=(b=s.value)==null?void 0:b.order)==null?void 0:A.orderNumber)||"..."),1)])])]),w.value?(r(),a("div",ke,[...t[8]||(t[8]=[e("div",{class:"w-12 h-12 border-4 border-primary-100 border-t-primary-600 rounded-full animate-spin"},null,-1),e("p",{class:"text-slate-400 font-medium animate-pulse"},"Retrieving order intelligence...",-1)])])):s.value?(r(),a("div",_e,[e("div",Ne,[e("div",je,[e("div",Ce,[t[9]||(t[9]=e("h3",{class:"font-black text-slate-900 uppercase text-sm tracking-widest"},"Order Composition",-1)),e("span",{class:ve(["px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest",te.value])},o(s.value.status),3)]),e("div",Re,[e("table",Ae,[t[12]||(t[12]=e("thead",null,[e("tr",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest border-b border-slate-50"},[e("th",{class:"px-8 py-4"},"Item Details"),e("th",{class:"px-8 py-4 text-center"},"Qty"),e("th",{class:"px-8 py-4 text-right"},"Price")])],-1)),e("tbody",Pe,[(r(!0),a(J,null,Y((P=s.value.order)==null?void 0:P.items,l=>{var p,K,Q;return r(),a("tr",{key:l._id,class:"group"},[e("td",Ie,[e("div",De,[e("div",Ve,[(p=l.product)!=null&&p.image?(r(),a("img",{key:0,src:l.product.image,class:"w-full h-full object-cover"},null,8,qe)):(r(),a("div",ze,[...t[10]||(t[10]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"})],-1)])]))]),e("div",null,[e("p",Ee,o(((K=l.product)==null?void 0:K.title)||"Unknown Item"),1),e("p",Oe,o(((Q=l.product)==null?void 0:Q.category)||"General"),1)])])]),e("td",Se,"x"+o(l.quantity),1),e("td",Be,"₦"+o((l.price*l.quantity).toLocaleString()),1)])}),128))]),e("tfoot",null,[e("tr",Me,[t[11]||(t[11]=e("td",{colspan:"2",class:"px-8 py-6 text-slate-500 uppercase text-xs tracking-widest"},"Grand Total Value",-1)),e("td",Te,"₦"+o(s.value.amount.toLocaleString()),1)])])])])]),e("div",Fe,[e("div",Le,[t[16]||(t[16]=e("h4",{class:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4"},"Delivery Intelligence",-1)),e("div",Ue,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-[10px] font-bold text-slate-400 uppercase"},"Destination Address",-1)),e("p",Ge,o(((D=(I=s.value.order)==null?void 0:I.deliveryAddress)==null?void 0:D.street)||"N/A")+", "+o(((q=(V=s.value.order)==null?void 0:V.deliveryAddress)==null?void 0:q.city)||""),1)]),e("div",$e,[e("div",null,[t[14]||(t[14]=e("p",{class:"text-[10px] font-bold text-slate-400 uppercase"},"Contact Name",-1)),e("p",He,o(((E=(z=s.value.order)==null?void 0:z.deliveryAddress)==null?void 0:E.contactName)||((O=s.value.user)==null?void 0:O.firstName)),1)]),e("div",null,[t[15]||(t[15]=e("p",{class:"text-[10px] font-bold text-slate-400 uppercase"},"Phone",-1)),e("p",Ke,o(((B=(S=s.value.order)==null?void 0:S.deliveryAddress)==null?void 0:B.phone)||"N/A"),1)])])])]),t[17]||(t[17]=fe('<div class="bg-white p-6 rounded-3xl border border-slate-200 shadow-sm flex flex-col justify-center text-center"><div class="mx-auto w-12 h-12 bg-primary-100 rounded-2xl flex items-center justify-center text-primary-600 mb-4"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><h4 class="font-black text-slate-900 uppercase text-xs tracking-widest">Order Strategy</h4><p class="text-sm text-slate-500 mt-2 px-4">This order will be fulfilled via <span class="font-bold text-slate-700">Genory Logistics</span> upon approval.</p></div>',1))])]),e("div",Qe,[e("div",Je,[e("div",Ye,o((M=s.value.user)==null?void 0:M.firstName[0])+o((T=s.value.user)==null?void 0:T.lastName[0]),1),e("h3",We,o((F=s.value.user)==null?void 0:F.firstName)+" "+o((L=s.value.user)==null?void 0:L.lastName),1),e("p",Xe,o((U=s.value.user)==null?void 0:U.email),1),e("div",Ze,[e("div",null,[t[18]||(t[18]=e("p",{class:"text-[10px] font-black text-slate-400 uppercase tracking-tighter"},"Staff ID",-1)),e("p",et,o(((G=s.value.user)==null?void 0:G.hrEmployeeId)||"GEN-ST-001"),1)]),e("div",null,[t[19]||(t[19]=e("p",{class:"text-[10px] font-black text-slate-400 uppercase tracking-tighter"},"Requested On",-1)),e("p",tt,o(new Date(s.value.createdAt).toLocaleDateString()),1)])])]),s.value.status==="pending"?(r(),a("div",st,[t[21]||(t[21]=e("div",{class:"absolute top-0 right-0 -mr-8 -mt-8 w-32 h-32 bg-primary-600 opacity-10 rounded-full blur-3xl group-hover:opacity-20 transition-opacity"},null,-1)),t[22]||(t[22]=e("h4",{class:"text-lg font-black text-white italic uppercase tracking-wider mb-6"},"Action Protocol",-1)),N(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=l=>k.value=l),placeholder:"Reviewer notes (optional)...",class:"w-full bg-slate-800 border border-slate-700 rounded-2xl p-4 text-white text-sm placeholder:text-slate-500 outline-none focus:border-primary-500 transition-colors mb-6 resize-none h-24"},null,512),[[j,k.value]]),e("div",ot,[e("button",{onClick:t[1]||(t[1]=l=>R("approve")),class:"w-full py-4 bg-emerald-500 text-white font-black rounded-2xl hover:bg-emerald-600 transition-all flex items-center justify-center space-x-2"},[...t[20]||(t[20]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),e("span",null,"APPROVE ORDER",-1)])]),e("button",{onClick:t[2]||(t[2]=l=>R("reject")),class:"w-full py-4 bg-slate-800 text-rose-500 font-bold rounded-2xl hover:bg-slate-700 transition-all border border-slate-700"}," REJECT REQUEST ")])])):(r(),a("div",lt,[e("div",at,[t[23]||(t[23]=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)),e("span",rt,o(s.value.status==="approved"?"Authorization Confirmed":"Authorization Denied"),1)]),e("div",nt,[t[24]||(t[24]=e("p",{class:"text-[10px] font-black text-slate-400 uppercase tracking-tighter"},"Processed By",-1)),e("p",it,o((($=s.value.processedBy)==null?void 0:$.firstName)||"System")+" "+o(((H=s.value.processedBy)==null?void 0:H.lastName)||""),1)]),s.value.processedNotes?(r(),a("div",dt,' "'+o(s.value.processedNotes)+'" ',1)):u("",!0),s.value.rejectionReason?(r(),a("div",ut,' Reason: "'+o(s.value.rejectionReason)+'" ',1)):u("",!0)]))])])):u("",!0),g.value?(r(),a("div",ct,[e("div",pt,[e("div",xt,[t[26]||(t[26]=e("div",{class:"w-16 h-16 bg-slate-100 rounded-3xl mx-auto mb-6 flex items-center justify-center"},[e("svg",{class:"w-8 h-8 text-slate-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})])],-1)),t[27]||(t[27]=e("h3",{class:"text-2xl font-black text-slate-900 italic tracking-tight"},"Security Clearance",-1)),d.value?(r(),a("p",ft,"Enter the verification code sent to your email.")):(r(),a("p",vt,"Enter your company approval PIN to continue.")),f.value?(r(),a("div",mt,o(f.value),1)):u("",!0),c.value?(r(),a("div",bt,o(c.value),1)):u("",!0),d.value?u("",!0):(r(),a("div",ht,[(r(),a(J,null,Y(4,l=>N(e("input",{key:l,"onUpdate:modelValue":p=>x.value[l-1]=p,ref_for:!0,ref_key:"pinInputs",ref:y,type:"password",maxlength:"1",class:"w-12 h-16 bg-slate-50 border-2 border-slate-100 rounded-2xl text-center text-2xl font-black focus:bg-white focus:border-primary-500 outline-none transition-all",onInput:p=>se(l-1,p),onKeydown:me(p=>oe(l-1),["delete"])},null,40,gt),[[j,x.value[l-1]]])),64))])),d.value?(r(),a("div",yt,[N(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>m.value=l),type:"text",maxlength:"6",placeholder:"000000",class:"w-full h-16 bg-slate-50 border-2 border-slate-100 rounded-2xl text-center text-3xl font-black tracking-[1em] focus:bg-white focus:border-primary-500 outline-none transition-all placeholder:tracking-normal placeholder:text-slate-200",autofocus:""},null,512),[[j,m.value]]),t[25]||(t[25]=e("p",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-widest"},"6-Digit Verification Code",-1))])):u("",!0),e("div",wt,[e("button",{onClick:t[4]||(t[4]=l=>g.value=!1),class:"flex-1 py-4 text-slate-400 font-bold hover:text-slate-600 transition-colors"},"Cancel"),e("button",{onClick:le,disabled:!d.value&&x.value.join("").length<4||d.value&&m.value.length<6||h.value,class:"flex-1 py-4 bg-slate-900 text-white font-black rounded-2xl hover:bg-slate-800 disabled:opacity-50 transition-all shadow-xl shadow-slate-900/20"},o(h.value?"...":d.value?"VERIFY":"CONFIRM"),9,kt)])])])])):u("",!0)])}}});typeof W=="function"&&W(_t);export{_t as default};
